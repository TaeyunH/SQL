Create a Table in the TSQL DB
Named “SalesReport”
Populate the Table with the Top 20 largest total orders by total order sales
Include the following columns:
CustomerID, CustomerName, Total Sales
Submit query or queries and screen-shot of the table in SSMS.


/*
CREATE TABLE TSQL.SalesReport (
    OrderID INT NOT NULL,
    ProductID INT NOT NULL,
    UnitPrice DECIMAL(10, 2) NOT NULL,
    Quantity INT NOT NULL,
    Discount FLOAT DEFAULT 0,
    PRIMARY KEY (OrderID, ProductID)
);


INSERT INTO TSQL.SalesReport (OrderID, ProductID, UnitPrice, Quantity, Discount)
SELECT OrderID, ProductID, UnitPrice, Quantity, Discount
FROM Sales.OrderDetails;

*/

SELECT TOP 20 o.OrderID, p.CustomerID, q.ContactName, 
       Round((o.UnitPrice * o.Quantity) * (1 - ISNULL(o.Discount, 0)),2) AS TotalOrderAmount
FROM TSQL.SalesReport o
JOIN Sales.Orders p ON o.OrderID = p.OrderID
JOIN Sales.Customers q ON p.CustomerID = q.CustomerID
order by TotalOrderAmount DESC;

